<!DOCTYPE html>
<html>
<head>
  <title>Register</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <style>
    /* Dark Mode Toggle Button */
    .toggle-btn {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      z-index:100;
      background-color: transparent;
      border: 2px solid #007bff;
      color: #007bff;
      padding: 8px 16px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      transition: 0.3s;
    }

    .toggle-btn:hover {
      background-color: #007bff;
      color: white;
    }

    /* Push form down below toggle */
    .register-container {
      margin-top: 80px; /* adjust as needed */
    }
  </style>
</head>
<body>
  <img src="{{ url_for('static', filename='images/slide1.jpg') }}" class="background-img" alt="Background">
  <!-- âœ… Dark Mode Toggle Button -->
  <button onclick="toggleDarkMode()" class="toggle-btn">
    ðŸŒ™ Toggle Dark Mode
  </button>

  <div class="container" style="margin-top: 80px;">
    <h2>Register</h2>
    <form method="POST">
      <input type="text" name="username" placeholder="Username" required /><br>
      <input type="email" name="actual_email" placeholder="Your Real Email" required /><br>
      <input type="password" name="password" placeholder="Password" required /><br>

      <label>Role:</label>
      <select name="role" id="role" required onchange="toggleHospitalFields()">
        <option value="patient" {% if request.form.get('role') == 'patient' %}selected{% endif %}>Patients</option>
        <option value="doctor" {% if request.form.get('role') == 'doctor' %}selected{% endif %}>Hospital Officials</option>
      </select><br><br>

      <div id="hospital-fields" style="display: none;">
        <label>Doctor Code:</label>
        <input type="text" name="doc_code" placeholder="Only for Hospital officials"
              value="{{ request.form.get('doc_code','') }}" /><br><br>

        <label>Select Clinic:</label>
        <select name="clinic_id">
          <option value="">Select a clinic</option>
          {% for clinic in clinics %}
            <option value="{{ clinic.id }}" {% if request.form.get('clinic_id') == clinic.id|string %}selected{% endif %}>
              {{ clinic.name }} ({{ clinic.location }})
            </option>
          {% endfor %}
        </select><br><br>

        <label>Select Speciality:</label>
        <select name="speciality">
          <option value="">Select a speciality</option>
          <option value="oncologist" {% if request.form.get('speciality') == 'oncologist' %}selected{% endif %}>Oncologist</option>
          <option value="dermatologist" {% if request.form.get('speciality') == 'dermatologist' %}selected{% endif %}>Dermatologist</option>
          <option value="neurologist" {% if request.form.get('speciality') == 'neurologist' %}selected{% endif %}>Neurologist</option>
          <option value="pediatrician" {% if request.form.get('speciality') == 'pediatrician' %}selected{% endif %}>Pediatrician</option>
          <option value="orthodontist" {% if request.form.get('speciality') == 'orthodontist' %}selected{% endif %}>Orthodontist</option>
        </select><br><br>
      </div>

      <button type="submit">Register</button>
    </form>
    <p style="margin-top: 6px;"><a href="/login">Already have an account? Login</a></p>
  </div>

  <script>
    function toggleDarkMode() {
      document.body.classList.toggle('dark-mode');
      localStorage.setItem('darkMode', document.body.classList.contains('dark-mode'));
    }

    window.onload = function () {
      if (localStorage.getItem('darkMode') === 'true') {
        document.body.classList.add('dark-mode');
      }
    };

    function toggleHospitalFields() {
      const role = document.getElementById("role").value;
      const hospitalFields = document.getElementById("hospital-fields");
      hospitalFields.style.display = (role === "doctor") ? "block" : "none";
    }

    document.addEventListener("DOMContentLoaded", toggleHospitalFields);
  </script>

</body>

</html>